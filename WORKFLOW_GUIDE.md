# GitHub Actions å·¥ä½œæµé…ç½®æŒ‡å—

## å½“å‰å·¥ä½œæµé…ç½®

ä¸ºäº†é¿å…ä¸€æ¬¡æäº¤è§¦å‘å¤šä¸ªæµæ°´çº¿ï¼Œæˆ‘ä»¬ä¼˜åŒ–äº†å·¥ä½œæµé…ç½®ï¼š

### ğŸš€ ä¸»è¦éƒ¨ç½²å·¥ä½œæµ

**æ–‡ä»¶ï¼š** `direct-deploy.yml`  
**åç§°ï¼š** ğŸš€ Deploy Next.js Application

**è§¦å‘æ¡ä»¶ï¼š**
- æ¨é€åˆ° `main` æˆ– `master` åˆ†æ”¯æ—¶è‡ªåŠ¨è§¦å‘
- æ”¯æŒæ‰‹åŠ¨è§¦å‘ï¼ˆå¯é€‰æ‹©ç¯å¢ƒï¼‰

**åŠŸèƒ½ï¼š**
- âœ… å®Œæ•´çš„æ„å»ºå’Œéƒ¨ç½²æµç¨‹
- âœ… ä»£ç æ£€æŸ¥ï¼ˆlintingï¼‰
- âœ… Docker é•œåƒæ„å»ºå’Œæ¨é€
- âœ… è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨
- âœ… å¥åº·æ£€æŸ¥
- âœ… è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯

### ğŸ”§ å¿«é€Ÿéƒ¨ç½²å·¥ä½œæµ

**æ–‡ä»¶ï¼š** `quick-deploy.yml`  
**åç§°ï¼š** Quick Deploy Next.js

**è§¦å‘æ¡ä»¶ï¼š**
- ä»…æ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰

**åŠŸèƒ½ï¼š**
- âœ… å¿«é€Ÿéƒ¨ç½²ï¼ˆä¸æ„å»º Docker é•œåƒï¼‰
- âœ… æ”¯æŒç¯å¢ƒé€‰æ‹©
- âœ… é€‚åˆæµ‹è¯•å’Œå¿«é€Ÿè¿­ä»£

## å·²ç¦ç”¨çš„å·¥ä½œæµ

ä¸ºäº†é¿å…å†²çªï¼Œä»¥ä¸‹å·¥ä½œæµå·²è¢«ç¦ç”¨ï¼š

- `deploy.yml.bak` - åŸæ¥çš„ artifacts å·¥ä½œæµ
- `simple-deploy.yml.bak` - é‡å¤çš„éƒ¨ç½²å·¥ä½œæµ

## ä½¿ç”¨æ–¹å¼

### 1. è‡ªåŠ¨éƒ¨ç½²

æ¨é€ä»£ç åˆ° `main` æˆ– `master` åˆ†æ”¯æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘éƒ¨ç½²ï¼š

```bash
git add .
git commit -m "feat: æ–°åŠŸèƒ½"
git push origin main
```

### 2. æ‰‹åŠ¨éƒ¨ç½²

åœ¨ GitHub Actions é¡µé¢æ‰‹åŠ¨è§¦å‘éƒ¨ç½²ï¼š

1. è¿›å…¥ GitHub ä»“åº“
2. ç‚¹å‡» "Actions" æ ‡ç­¾
3. é€‰æ‹© "ğŸš€ Deploy Next.js Application"
4. ç‚¹å‡» "Run workflow"
5. é€‰æ‹©åˆ†æ”¯å’Œç¯å¢ƒ
6. ç‚¹å‡» "Run workflow"

### 3. å¿«é€Ÿéƒ¨ç½²

å¯¹äºå¿«é€Ÿæµ‹è¯•ï¼Œä½¿ç”¨å¿«é€Ÿéƒ¨ç½²å·¥ä½œæµï¼š

1. åœ¨ Actions é¡µé¢é€‰æ‹© "Quick Deploy Next.js"
2. é€‰æ‹©ç¯å¢ƒï¼ˆproduction/stagingï¼‰
3. ç‚¹å‡» "Run workflow"

## å·¥ä½œæµæ­¥éª¤è¯¦è§£

### ğŸš€ Deploy Next.js Application

1. **ğŸ“¥ Checkout code** - æ£€å‡ºä»£ç 
2. **ğŸ”§ Setup Node.js** - è®¾ç½® Node.js ç¯å¢ƒ
3. **ğŸ“¦ Install dependencies** - å®‰è£…ä¾èµ–
4. **ğŸ” Run linting** - ä»£ç æ£€æŸ¥
5. **ğŸ—ï¸ Build Next.js application** - æ„å»ºåº”ç”¨
6. **âœ… Verify build output** - éªŒè¯æ„å»ºç»“æœ
7. **ğŸ³ Set up Docker Buildx** - è®¾ç½® Docker æ„å»ºç¯å¢ƒ
8. **ğŸ” Log in to Container Registry** - ç™»å½•å®¹å™¨ä»“åº“
9. **ğŸ³ Build and push Docker image** - æ„å»ºå¹¶æ¨é€ Docker é•œåƒ
10. **ğŸš€ Deploy to server** - éƒ¨ç½²åˆ°æœåŠ¡å™¨

### Quick Deploy Next.js

1. **ğŸ“¥ Checkout code** - æ£€å‡ºä»£ç 
2. **ğŸš€ Deploy to server** - ç›´æ¥éƒ¨ç½²åˆ°æœåŠ¡å™¨

## ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿åœ¨ GitHub Secrets ä¸­é…ç½®ä»¥ä¸‹å˜é‡ï¼š

| Secret åç§° | æè¿° | ç¤ºä¾‹å€¼ |
|------------|------|--------|
| `HOST` | æœåŠ¡å™¨ IP åœ°å€ | `192.168.1.100` |
| `USERNAME` | SSH ç”¨æˆ·å | `ubuntu` |
| `SSH_KEY` | SSH ç§é’¥ | `-----BEGIN OPENSSH PRIVATE KEY-----...` |
| `PORT` | SSH ç«¯å£ | `22` |

## æ•…éšœæ’é™¤

### 1. å·¥ä½œæµæœªè§¦å‘

æ£€æŸ¥ï¼š
- åˆ†æ”¯åç§°æ˜¯å¦æ­£ç¡®ï¼ˆmain æˆ– masterï¼‰
- å·¥ä½œæµæ–‡ä»¶æ˜¯å¦åœ¨ `.github/workflows/` ç›®å½•ä¸‹
- æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®

### 2. æ„å»ºå¤±è´¥

æ£€æŸ¥ï¼š
- Node.js ç‰ˆæœ¬å…¼å®¹æ€§
- ä¾èµ–å®‰è£…æ˜¯å¦æˆåŠŸ
- æ„å»ºæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### 3. éƒ¨ç½²å¤±è´¥

æ£€æŸ¥ï¼š
- GitHub Secrets é…ç½®
- æœåŠ¡å™¨ SSH è¿æ¥
- Docker å’Œ Docker Compose çŠ¶æ€

## æœ€ä½³å®è·µ

1. **ä½¿ç”¨ä¸»å·¥ä½œæµ**ï¼šæ—¥å¸¸å¼€å‘ä½¿ç”¨ "ğŸš€ Deploy Next.js Application"
2. **å¿«é€Ÿæµ‹è¯•**ï¼šä½¿ç”¨ "Quick Deploy Next.js" è¿›è¡Œå¿«é€Ÿæµ‹è¯•
3. **ä»£ç è´¨é‡**ï¼šç¡®ä¿ä»£ç é€šè¿‡ linting æ£€æŸ¥
4. **ç›‘æ§éƒ¨ç½²**ï¼šå…³æ³¨ GitHub Actions çš„æ‰§è¡ŒçŠ¶æ€
5. **æ—¥å¿—åˆ†æ**ï¼šæŸ¥çœ‹è¯¦ç»†çš„æ„å»ºå’Œéƒ¨ç½²æ—¥å¿—

## æ¢å¤ç¦ç”¨çš„å·¥ä½œæµ

å¦‚æœéœ€è¦æ¢å¤æŸä¸ªå·¥ä½œæµï¼š

```bash
# æ¢å¤ simple-deploy.yml
mv .github/workflows/simple-deploy.yml.bak .github/workflows/simple-deploy.yml

# æ¢å¤ deploy.yml
mv .github/workflows/deploy.yml.bak .github/workflows/deploy.yml
```

**æ³¨æ„ï¼š** æ¢å¤åéœ€è¦ä¿®æ”¹è§¦å‘æ¡ä»¶ä»¥é¿å…å†²çªã€‚ 